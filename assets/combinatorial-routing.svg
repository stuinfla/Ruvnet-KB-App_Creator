<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" width="800" height="600">
<!-- Cache invalidation: 2026-01-01 -->
  <defs>
    <!-- Background gradient -->
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e"/>
      <stop offset="50%" style="stop-color:#16213e"/>
      <stop offset="100%" style="stop-color:#1a1a2e"/>
    </linearGradient>

    <!-- Cyan gradient for primary elements -->
    <linearGradient id="cyanGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#00d4ff"/>
      <stop offset="100%" style="stop-color:#0099cc"/>
    </linearGradient>

    <!-- Purple gradient -->
    <linearGradient id="purpleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#6d28d9"/>
    </linearGradient>

    <!-- Green gradient -->
    <linearGradient id="greenGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>

    <!-- Orange gradient for medium confidence -->
    <linearGradient id="orangeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>

    <!-- Glow filter -->
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <!-- Soft shadow -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="800" height="600" fill="url(#bgGradient)"/>

  <!-- Subtle grid pattern -->
  <g opacity="0.05">
    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#fff" stroke-width="1"/>
    </pattern>
    <rect width="800" height="600" fill="url(#grid)"/>
  </g>

  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" fill="#fff" font-family="system-ui, -apple-system, sans-serif" font-size="18" font-weight="600" opacity="0.9">
    Pattern 2: Combinatorial Routing (Attention-First)
  </text>

  <!-- User Query Box -->
  <g filter="url(#shadow)">
    <rect x="150" y="55" width="500" height="60" rx="12" fill="#0f0f23" stroke="url(#cyanGradient)" stroke-width="2"/>
    <text x="180" y="78" fill="#00d4ff" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" opacity="0.8">
      USER QUERY
    </text>
    <text x="400" y="100" text-anchor="middle" fill="#fff" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="500">
      "Find me cheap business class to Tokyo using points"
    </text>
  </g>

  <!-- Connection line from query to router -->
  <path d="M 400 115 L 400 150" stroke="url(#cyanGradient)" stroke-width="2" stroke-dasharray="4,4" opacity="0.6"/>
  <polygon points="400,155 395,145 405,145" fill="#00d4ff" opacity="0.8"/>

  <!-- MoE Expert Routing Box -->
  <g filter="url(#shadow)">
    <rect x="100" y="160" width="600" height="300" rx="16" fill="#0f0f23" stroke="url(#purpleGradient)" stroke-width="2"/>

    <!-- Header -->
    <rect x="100" y="160" width="600" height="40" rx="16" fill="url(#purpleGradient)" opacity="0.15"/>
    <rect x="100" y="185" width="600" height="15" fill="#0f0f23"/>
    <text x="400" y="185" text-anchor="middle" fill="#8b5cf6" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="700">
      MoE EXPERT ROUTING
    </text>
  </g>

  <!-- Expert 1: Award Travel Expert (Primary - highest confidence) -->
  <g filter="url(#glow)">
    <rect x="140" y="220" width="220" height="80" rx="10" fill="#0a1628" stroke="url(#greenGradient)" stroke-width="2"/>
    <circle cx="160" cy="240" r="8" fill="url(#greenGradient)"/>
    <text x="175" y="244" fill="#10b981" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600">
      PRIMARY
    </text>
    <text x="160" y="268" fill="#fff" font-family="system-ui, -apple-system, sans-serif" font-size="13" font-weight="600">
      Award Travel Expert
    </text>

    <!-- Confidence bar background -->
    <rect x="160" y="280" width="180" height="8" rx="4" fill="#1e293b"/>
    <!-- Confidence bar fill (85%) -->
    <rect x="160" y="280" width="153" height="8" rx="4" fill="url(#greenGradient)"/>
    <text x="345" y="288" fill="#10b981" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="700">
      0.85
    </text>
  </g>

  <!-- Expert 2: Cash Fares Expert (Low confidence - dimmed) -->
  <g opacity="0.5">
    <rect x="290" y="315" width="220" height="80" rx="10" fill="#0a1628" stroke="#64748b" stroke-width="1.5"/>
    <text x="310" y="348" fill="#94a3b8" font-family="system-ui, -apple-system, sans-serif" font-size="13" font-weight="500">
      Cash Fares Expert
    </text>

    <!-- Confidence bar background -->
    <rect x="310" y="360" width="180" height="8" rx="4" fill="#1e293b"/>
    <!-- Confidence bar fill (45%) -->
    <rect x="310" y="360" width="81" height="8" rx="4" fill="#64748b"/>
    <text x="495" y="368" fill="#64748b" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600">
      0.45
    </text>
  </g>

  <!-- Expert 3: Positioning Expert (Medium confidence) -->
  <g>
    <rect x="440" y="220" width="220" height="80" rx="10" fill="#0a1628" stroke="url(#orangeGradient)" stroke-width="2"/>
    <circle cx="460" cy="240" r="8" fill="url(#orangeGradient)"/>
    <text x="475" y="244" fill="#f59e0b" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600">
      SELECTED
    </text>
    <text x="460" y="268" fill="#fff" font-family="system-ui, -apple-system, sans-serif" font-size="13" font-weight="600">
      Positioning Expert
    </text>

    <!-- Confidence bar background -->
    <rect x="460" y="280" width="180" height="8" rx="4" fill="#1e293b"/>
    <!-- Confidence bar fill (72%) -->
    <rect x="460" y="280" width="130" height="8" rx="4" fill="url(#orangeGradient)"/>
    <text x="645" y="288" fill="#f59e0b" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="700">
      0.72
    </text>
  </g>

  <!-- Routing Decision Box -->
  <g>
    <rect x="250" y="410" width="300" height="36" rx="8" fill="url(#purpleGradient)" opacity="0.2"/>
    <rect x="250" y="410" width="300" height="36" rx="8" fill="none" stroke="url(#purpleGradient)" stroke-width="1.5"/>
    <text x="400" y="433" text-anchor="middle" fill="#fff" font-family="system-ui, -apple-system, sans-serif" font-size="13" font-weight="600">
      Route to:
      <tspan fill="#10b981">Award</tspan>
      <tspan fill="#fff"> + </tspan>
      <tspan fill="#f59e0b">Positioning</tspan>
    </text>
  </g>

  <!-- Connection line from router to output -->
  <path d="M 400 460 L 400 490" stroke="url(#purpleGradient)" stroke-width="2" stroke-dasharray="4,4" opacity="0.6"/>
  <polygon points="400,495 395,485 405,485" fill="#8b5cf6" opacity="0.8"/>

  <!-- Output Box -->
  <g filter="url(#shadow)">
    <rect x="150" y="500" width="500" height="70" rx="12" fill="#0f0f23" stroke="url(#greenGradient)" stroke-width="2"/>
    <text x="180" y="525" fill="#10b981" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" opacity="0.8">
      OUTPUT
    </text>
    <text x="400" y="548" text-anchor="middle" fill="#fff" font-family="system-ui, -apple-system, sans-serif" font-size="13" font-weight="500">
      Response with:
      <tspan fill="#00d4ff">multi-expert synthesis</tspan>,
      <tspan fill="#10b981">optimal combinations</tspan>
    </text>
  </g>

  <!-- Decorative connection lines between experts -->
  <path d="M 250 260 Q 400 200 550 260" stroke="url(#cyanGradient)" stroke-width="1" fill="none" stroke-dasharray="2,4" opacity="0.3"/>
  <path d="M 250 280 Q 400 340 400 355" stroke="url(#greenGradient)" stroke-width="1" fill="none" stroke-dasharray="2,4" opacity="0.2"/>
  <path d="M 550 280 Q 400 340 400 355" stroke="url(#orangeGradient)" stroke-width="1" fill="none" stroke-dasharray="2,4" opacity="0.2"/>

  <!-- Legend -->
  <g transform="translate(620, 520)">
    <circle cx="10" cy="8" r="5" fill="url(#greenGradient)"/>
    <text x="22" y="12" fill="#94a3b8" font-family="system-ui, -apple-system, sans-serif" font-size="9">High (&gt;0.7)</text>
    <circle cx="10" cy="26" r="5" fill="url(#orangeGradient)"/>
    <text x="22" y="30" fill="#94a3b8" font-family="system-ui, -apple-system, sans-serif" font-size="9">Med (0.5-0.7)</text>
    <circle cx="10" cy="44" r="5" fill="#64748b"/>
    <text x="22" y="48" fill="#94a3b8" font-family="system-ui, -apple-system, sans-serif" font-size="9">Low (&lt;0.5)</text>
  </g>
</svg>